package com.myspace.ruleselection;

//import org.drools.runtime.rule.RuleContext;
import org.drools.core.spi.KnowledgeHelper;
import java.util.Map;
import java.util.List;
function boolean checkTaxonomy(KnowledgeHelper kdrools , String taxonomy) {

   String tx = (String)kdrools.getKieRuntime().getGlobal("Taxonomy");//channel
    System.out.println("Taxonomy" + tx);
    String txValue = (String)kdrools.getKieRuntime().getGlobal("TaxonomyValue");//ID
     System.out.println("TaxonomyValue" + txValue);
     boolean enabled = false;
     
    if ("UD".equals(taxonomy)){
         boolean enabled = true;
    }else {

         boolean enabled = false;
    }
    return enabled;
    
    
}

function boolean checkTaxonomy1(KnowledgeHelper kdrools ) {

   String tx = (String)kdrools.getKieRuntime().getGlobal("Taxonomy");//channel
    System.out.println("Taxonomy" + tx);
    String txValue = (String)kdrools.getKieRuntime().getGlobal("TaxonomyValue");//ID
     System.out.println("TaxonomyValue" + txValue);
    Map<String, Object> metaData =  kdrools.getRule().getMetaData();
    boolean enabled = ( (List)metaData.get(tx) ).contains(txValue);

    return false;
    
    
}

//from row number: 1
rule "Row 1 EligibilityRules"
	@channel("IWC","UD")
    enabled(checkTaxonomy1(drools))
	dialect "mvel"
	ruleflow-group "Eligibility"
	when
		trans : Transaction(  productCode == "10" )
	then
		trans.setEligibility( true );
end

//from row number: 2
rule "Row 2 EligibilityRules"
	@channel("IWC","UD")
	dialect "mvel"
	ruleflow-group "Eligibility"
	 enabled(checkTaxonomy1(drools))
	when
		trans : Transaction( type == "MUTUAL-FUNDS-EXCHANGE" , productCode == "6" )
	then
		trans.setEligibility( true );
end

//from row number: 3
rule "Row 3 EligibilityRules"
	@channel("UD")
	dialect "mvel"
	 enabled(checkTaxonomy1(drools))
	 ruleflow-group "Eligibility"
	when
		trans : Transaction( type == "MUTUAL-FUNDS-COST-BASIS-SETTINGS" , productCode == "10" )
	then
		trans.setEligibility( true );
end

//from row number: 4
rule "Row 4 EligibilityRules"
   
	@channel("IWC")
	dialect "mvel"
	 enabled(checkTaxonomy1(drools))
	 ruleflow-group "Eligibility"
	when
		trans : Transaction( type == "MUTUAL-FUNDS-REDEEM" , productCode == "20" )
	then
		trans.setEligibility( true );
end